<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jason's Notebook</title>
</head>
<body>
<h1>My Notebook</h1>
<h2>All Notes</h2>
<ul>
</ul>
<input type="button" value="全选" id="select" onclick="selectAll()" disabled="true">
<input type="button" value="删除" id="delete" onclick="deleteRow()" disabled="true">

<h2>Add a new note</h2>
<form action = "my-handling-from-page" method="post">
    <div>
        <label for="title">Enter the note title:</label>
        <input type="text" id = "title"/>

    </div>
    <ul></ul>
    <div>
        <label for="msg"></label>
        <textarea id="msg"  cols="43" rows="10"></textarea>

    </div>
</form>
<input type="button" value="Save" id="save">
<ul></ul>



<script>

    var list = document.querySelector('ul');
    var input = document.getElementById('title');
    var button = document.getElementById('save');
    var textarea = document.querySelector('textarea');
    button.onclick = function() {
        var selbutton = document.getElementById(("select"));
        selbutton.disabled = false;
        var myItem1 = input.value;

        var myItem2 = textarea.value;
        input.value = '';
        textarea.value = '';
        var listItem = document.createElement('li');
        var listText = document.createElement('span');
        var listTextB = document.createElement('B');
        var listCheck = document.createElement('input');

        listItem.appendChild(listCheck);
        listCheck.setAttribute("type","checkbox");
        listCheck.setAttribute("name",'checkbox');
        listCheck.setAttribute("onchange","checkBoxSel()")

        listItem.appendChild(listTextB);
        listItem.appendChild(listText);

        //myItem1.style.fontWeight = "Bold";
        listText.textContent = ' - ' + myItem2;
        listTextB.textContent = myItem1;

        //checkBoxNum();
        list.appendChild(listItem);

        input.focus();
    }
    function deleteRow(){
        var Tblen;
        // 得到所有 checkbox 对象
        var checkbox = document.getElementsByName("checkbox");
        //var checkboxlen = document.all.checkbox.length;
        // 得到所有提交的checkbox个数
        var checkboxlen = checkbox.length;
        var ischecked;
        var list = document.querySelector('ul');
        // 得到删除按钮对象
        var delbutton = document.getElementById("delete");
        for (var i=0; i < checkboxlen; i++){
            // 得到表格行数
            ischecked = checkbox[i].checked;
            // 如果当前的checkbox选中：删除当前节点，由于删除节点后，下面的节点上移，游标（记录行指针）也应该上移
            if (ischecked)
            {
                // document.all("mainTb").deleteRow(i);
                list.removeChild(list.childNodes[i]);
                // 游标（记录行指针）上移
                i--;
            }
            // 重新统计checkbox个数
            checkboxlen = checkbox.length;
        }
        // 删除操作后按钮状态是不可用
        delbutton.disabled = true;
        checkBoxSel();
        var selbutton= document.getElementById("select");
        if (checkboxlen>0){
            selbutton.disable = false;
        }
        else {
            selbutton.disabled = true;
        }
    }

    function checkBoxSel(){
        // 得到删除按钮对象
        var delbutton = document.getElementById("delete");
        //var
        var checkbox = document.getElementsByName("checkbox");
        var checkboxlen = checkbox.length;

        if(checkselect()){
            delbutton.disabled = false;
        }else{
            delbutton.disabled = true;
        }
    }
    function selectAll(){
        var checkbox = document.getElementsByName("checkbox");
        // 得到所有提交的checkbox个数
        var chklength = checkbox.length;
        for (var i=0;i<chklength;i++){
            checkbox[i].checked = true;
        }
        checkBoxSel();
    }
    function checkselect(){
        // 得到所有 checkbox 对象
        var checkbox = document.getElementsByName("checkbox");
        // 得到所有提交的checkbox个数
        var chklength = checkbox.length;
        var delbutton = document.getElementById("delete");
        var flag = false;
        var num = 0;
        for(var i = 0; i < chklength; i++)
        {
            if(checkbox[i].checked == true)
            {
                flag = true;
                //break;
                num = num+1;
            }
        }
        delbutton.value = "删除("+num+")";
        if(flag == true)
        {
            return true;
        } else {
            return false;
        }
    }
</script>
</body>
</html>
